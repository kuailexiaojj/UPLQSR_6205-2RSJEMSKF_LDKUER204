clc;clear all;
fs=5;
Ts=1/fs;
% N=10000;
N=10000;%调整 图形会变
% NN=5000;
h=1/fs;   
t=0:Ts:(N-1)*Ts;
% t=100:5:130;
A=1;
f0=0.0001;
f=0.002;
%D=0.3;%可跃迁
D=0.4;
% D=0.0005;% k=0.6;N=100000;
%k=0.95;%%k变化图形会变 D=0.0005时 K大于0.5 小于1.8；D=0.0015时 K大于0.8 小于1
a1=1;b1=1;b2=0.3;m=1.5;

% ff=fs.*(0:NN/2-1)/NN;
% ff0=find(ff==f0); 


%x0=0;
%x1=(1/2).*sqrt((-k).*(k-6));
%x2=(1/2).*sqrt((-k).*(k-4));
%x3=-(1/2).*sqrt((-k).*(k-6));
%x4=-(1/2).*sqrt((-k).*(k-4));
%x5=(1/2).*sqrt((-k).*(k-2));
%x6=-(1/2).*sqrt((-k).*(k-2));

x11=2.*m-sqrt(b1.\a1);x22=m;x33=sqrt(b1.\a1);x44=0;x55=-sqrt(b1.\a1);x66=-m;x77=-2.*m+sqrt(b1.\a1);

r13=(((D./(b2.^2)).*(exp((b2.*(m-sqrt(a1./b1))./D))+exp((b2.*(-m+sqrt(a1./b1)))./D)-2)).^(-1));
r35=((b2.\sqrt(b1.\a1)).*(1-exp((b2.*(-m+sqrt(b1.\a1)))./D)).*exp((4*b1.*D).\(a1.^2))).^(-1);
r57=((b2.\sqrt(b1.\a1)).*(-1+exp((b2.*(m-sqrt(b1.\a1)))./D)).*exp(-(4*b1.*D).\(a1.^2))).^(-1);
r75=r13;r53=r35;r31=r57;

p01=r31/((2.*r57)+2.*r13);
p03=r13/((2.*r57)+2.*r13);
p07=p01;p05=p03;

m1=2.*pi.*f.*(x22-x11);
m2=2.*r35.*(x11-x22)+r31.*(x11-x33);
m3=2.*pi.*f.*(r13.*(x11-x22)+r31.*(x33-x22));
m4=2.*r13.*r35.*(x11-x22);
m5=(2.*p03.*A.*pi.*f.*((x11-x22).^2).*(2.*r35.*x33+r31.*(x33-x11)))/D.*((m1.^2)+(m2.^2));
m6=A.*p03.*(r31.*x11-(r31+2.*r35).*x33);
m7=exp(((2.*r35.*(x22-x11)+r31.*(x33-x11))).*t)/(x11-x22);
m8=exp((2.*r13.*r35.*(x22-x11).*t)/(r13.*(x11-x22)+r31.*(x33-x22)));
m9=m8.*(p03-1/4-((A.*m3.*m4.*x33.*p03)/D.*((m3.^2)+(m4.^2))));
m10=(m6.*(m1.*cos(2.*pi.*f.*t)+m2.*sin(2.*pi.*f.*t)))/(D.*((m1.^2)+(m2.^2)));
m11=(2.*A.*p03.*x33.*r13.*r35.*(m4.*sin(2.*pi.*f.*t)-m3.*cos(2.*pi.*f.*t)))/(D.*((m3.^2)+(m4.^2)));
m12=(m7/(x11-x22)).*(4.*p03-1-4.*m5);

p1=p01+((r31.*(x22-x33))/(4.*r13)).*(((4.*m9)/(x22-x11))+4.*(m10+m11)+m12);
p7=p07-((r57.*(x55-x66))/(4.*r75)).*(((4.*m9)/(x77-x55))+4.*(m10+m11)+m12);
p3=p03+m7.*(-0.25+p03-m5)-m9+(x11-x22).*(m10+m11);
p5=p05-m7.*(-0.25+p05-m5)+m9-(x11-x22).*(m10+m11);

x1=x11.*(p1-p7)+x33.*(p3-p5);
%X=(x1.^2).*(p1-p3)+(x5.^2).*(p5-p6);
plot(t,x1);hold on;

A=1;
f0=0.0001;
f=0.002;
%D=0.3;%可跃迁
D=2;
% D=0.0005;% k=0.6;N=100000;
%k=0.95;%%k变化图形会变 D=0.0005时 K大于0.5 小于1.8；D=0.0015时 K大于0.8 小于1
a1=1;b1=1;b2=0.3;m=1.5;

% ff=fs.*(0:NN/2-1)/NN;
% ff0=find(ff==f0); 


%x0=0;
%x1=(1/2).*sqrt((-k).*(k-6));
%x2=(1/2).*sqrt((-k).*(k-4));
%x3=-(1/2).*sqrt((-k).*(k-6));
%x4=-(1/2).*sqrt((-k).*(k-4));
%x5=(1/2).*sqrt((-k).*(k-2));
%x6=-(1/2).*sqrt((-k).*(k-2));

x11=2.*m-sqrt(b1.\a1);x22=m;x33=sqrt(b1.\a1);x44=0;x55=-sqrt(b1.\a1);x66=-m;x77=-2.*m+sqrt(b1.\a1);

r13=(((D./(b2.^2)).*(exp((b2.*(m-sqrt(a1./b1))./D))+exp((b2.*(-m+sqrt(a1./b1)))./D)-2)).^(-1));
r35=((b2.\sqrt(b1.\a1)).*(1-exp((b2.*(-m+sqrt(b1.\a1)))./D)).*exp((4*b1.*D).\(a1.^2))).^(-1);
r57=((b2.\sqrt(b1.\a1)).*(-1+exp((b2.*(m-sqrt(b1.\a1)))./D)).*exp(-(4*b1.*D).\(a1.^2))).^(-1);
r75=r13;r53=r35;r31=r57;

p01=r31/((2.*r57)+2.*r13);
p03=r13/((2.*r57)+2.*r13);
p07=p01;p05=p03;

m1=2.*pi.*f.*(x22-x11);
m2=2.*r35.*(x11-x22)+r31.*(x11-x33);
m3=2.*pi.*f.*(r13.*(x11-x22)+r31.*(x33-x22));
m4=2.*r13.*r35.*(x11-x22);
m5=(2.*p03.*A.*pi.*f.*((x11-x22).^2).*(2.*r35.*x33+r31.*(x33-x11)))/D.*((m1.^2)+(m2.^2));
m6=A.*p03.*(r31.*x11-(r31+2.*r35).*x33);
m7=exp(((2.*r35.*(x22-x11)+r31.*(x33-x11))).*t)/(x11-x22);
m8=exp((2.*r13.*r35.*(x22-x11).*t)/(r13.*(x11-x22)+r31.*(x33-x22)));
m9=m8.*(p03-1/4-((A.*m3.*m4.*x33.*p03)/D.*((m3.^2)+(m4.^2))));
m10=(m6.*(m1.*cos(2.*pi.*f.*t)+m2.*sin(2.*pi.*f.*t)))/(D.*((m1.^2)+(m2.^2)));
m11=(2.*A.*p03.*x33.*r13.*r35.*(m4.*sin(2.*pi.*f.*t)-m3.*cos(2.*pi.*f.*t)))/(D.*((m3.^2)+(m4.^2)));
m12=(m7/(x11-x22)).*(4.*p03-1-4.*m5);

p1=p01+((r31.*(x22-x33))/(4.*r13)).*(((4.*m9)/(x22-x11))+4.*(m10+m11)+m12);
p7=p07-((r57.*(x55-x66))/(4.*r75)).*(((4.*m9)/(x77-x55))+4.*(m10+m11)+m12);
p3=p03+m7.*(-0.25+p03-m5)-m9+(x11-x22).*(m10+m11);
p5=p05-m7.*(-0.25+p05-m5)+m9-(x11-x22).*(m10+m11);

x2=x11.*(p1-p7)+x33.*(p3-p5)+0.75;
%X=(x1.^2).*(p1-p3)+(x5.^2).*(p5-p6);
plot(t,x2);
%plot(t,X);
% xlim([100000 130000]);
xlabel('t','FontSize', 14)
ylabel('<x(t)>','FontSize', 14)
ylim([-5 5])
xlim([0.8 2000])
%legend('<x(t)>','<x(t)x(t)>','Location','Best');