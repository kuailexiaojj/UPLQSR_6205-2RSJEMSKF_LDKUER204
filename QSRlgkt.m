
function x=QSRlgkt(a3,b3,c3,h1,h,x1)
x=zeros(1,length(x1));


for i=1:length(x1)-1
        if abs(x(i))>3
        x(i)=sign(x(i))*3;
        end
    k1=h*((h1*x(i))-h1*((a3.*b3+b3.*c3+c3.*a3)./(a3.*b3.*c3)).*x(i).^3+h1*((a3+b3+c3)./(a3.*b3.*c3)).*x(i).^5-(1/(a3.*b3.*c3)).*x(i).^7+x1(i));

    k2=h*((h1*(x(i)+k1/2))-h1*((a3.*b3+b3.*c3+c3.*a3)./(a3.*b3.*c3)).*(x(i)+k1/2).^3+h1*((a3+b3+c3)./(a3.*b3.*c3)).*(x(i)+k1/2).^5-(1/(a3.*b3.*c3)).*(x(i)+k1/2).^7+x1(i));

    k3=h*((h1*(x(i)+k2/2))-h1*((a3.*b3+b3.*c3+c3.*a3)./(a3.*b3.*c3)).*(x(i)+k2/2).^3+h1*((a3+b3+c3)./(a3.*b3.*c3)).*(x(i)+k2/2).^5-(1/(a3.*b3.*c3)).*(x(i)+k2/2).^7+x1(i+1));
    
    k4=h*((h1*(x(i)+k3))-h1*((a3.*b3+b3.*c3+c3.*a3)./(a3.*b3.*c3)).*(x(i)+k3).^3+h1*((a3+b3+c3)./(a3.*b3.*c3)).*(x(i)+k3).^5-(1/(a3.*b3.*c3)).*(x(i)+k3).^7+x1(i+1));
    x(i+1)=x(i)+(1/6)*(k1+2*k2+2*k3+k4);
end
end
